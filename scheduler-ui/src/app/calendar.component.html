<div class="calendar-container">
  <!-- Toolbar -->
  <div class="toolbar">
    <button (click)="openNewClassModal()" class="btn-primary">+ Add Class</button>
    <div class="view-switcher">
      <button 
        [class.active]="selectedView === 'week'"
        (click)="switchView('week')">
        Week
      </button>
      <button 
        [class.active]="selectedView === 'day'"
        (click)="switchView('day')">
        Day
      </button>
      <button 
        [class.active]="selectedView === 'explore'"
        (click)="switchView('explore')">
        Explore
      </button>
    </div>
  </div>

  <!-- Conflicts Alert -->
  <div *ngIf="conflicts.length > 0" class="conflicts-alert">
    <strong>⚠️ {{ conflicts.length }} Schedule Conflict(s) Detected</strong>
    <ul>
      <li *ngFor="let conflict of conflicts">
        {{ conflict.className1 }} conflicts with {{ conflict.className2 }}: {{ conflict.reason }}
      </li>
    </ul>
  </div>

  <!-- Week View -->
  <div *ngIf="selectedView === 'week'" class="week-view">
    <div class="week-nav">
      <button (click)="previousWeek()">← Previous</button>
      <h3>{{ formatDate(currentWeekStart) }} - {{ formatDate(getWeekDates()[6]) }}</h3>
      <button (click)="nextWeek()">Next →</button>
    </div>

    <div class="calendar-grid">
      <div class="time-column">
        <div class="day-header">Time</div>
        <div *ngFor="let slot of timeSlots" class="time-slot">
          {{ slot }}
        </div>
      </div>

      <div *ngFor="let dayIndex of [0, 1, 2, 3, 4, 5, 6]" class="day-column">
        <div class="day-header">
          {{ weekDays[dayIndex] }}<br>
          <small>{{ formatDate(getWeekDates()[dayIndex]) }}</small>
        </div>
        <div class="day-grid">
          <div *ngFor="let slot of timeSlots" class="grid-slot"></div>
          <div 
            *ngFor="let classItem of getClassesForDay(dayIndex)" 
            class="class-event"
            [class.has-conflict]="hasConflict(classItem)"
            [style.top]="getClassPosition(classItem).top"
            [style.height]="getClassPosition(classItem).height"
            [style.background-color]="getPriorityColor(classItem.priority)"
            (click)="onClassClick(classItem)">
            <div class="event-title">{{ classItem.name }}</div>
            <div class="event-time">{{ classItem.startTime }}</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Day View -->
  <div *ngIf="selectedView === 'day'" class="day-view">
    <p>Day view coming soon...</p>
  </div>

  <!-- Explore View -->
  <div *ngIf="selectedView === 'explore'" class="explore-view">
    <app-schedule-explorer></app-schedule-explorer>
  </div>

  <!-- Edit Modal -->
  <app-edit-class-modal
    *ngIf="showEditModal"
    [class]="editingClass"
    (saved)="onClassSaved($event)"
    (closed)="onModalClosed()">
  </app-edit-class-modal>
</div>
